// @ts-nocheck
var sheet = SpreadsheetApp.getActiveSheet();    // ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡πÉ‡∏´‡πâ sheet ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
var data = sheet.getDataRange().getValues();    // ‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å‡∏ä‡πà‡∏ß‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
var date = data[0][12];                          // ‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡πà‡∏ß‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ ‡πÅ‡∏ñ‡∏ß‡∏ô‡∏≠‡∏ô 1+1 ‡πÅ‡∏ñ‡∏ß‡∏ï‡∏±‡πâ‡∏á 9+1
var SEND = 'SEND';                              // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ ‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡∏µ‡πâ

function report() {                             // ‡∏ä‡∏∑‡πà‡∏≠‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡πà‡∏ô report

    for (var i=1;i<data.length;++i){            // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÉ‡∏´‡πà‡∏ß‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•(loop) ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏µ‡πà 1 ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≠‡∏ö‡∏ñ‡∏∂‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏´‡∏¢‡∏∏‡∏î ‡πÇ‡∏î‡∏¢‡∏ö‡∏ß‡∏Å‡πÑ‡∏õ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢‡πÜ‡∏ó‡∏µ‡∏•‡∏∞ 1
      var row = data[i];                        // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ä‡πà‡∏ß‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏ô loop ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å i=1‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ñ‡∏ß‡πÉ‡∏ô[1] ‡∏Ñ‡∏∑‡∏≠‡πÅ‡∏ñ‡∏ß‡∏ô‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1+1 = 2 ‡πÇ‡∏î‡∏¢‡∏ö‡∏ß‡∏Å‡πÑ‡∏õ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢‡πÜ‡∏ó‡∏µ‡∏•‡∏∞ 1
      var Sent = row[10];                        // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏à‡∏≤‡∏Å‡∏£‡∏≠‡∏ö‡πÅ‡∏£‡∏Å(‡πÅ‡∏ñ‡∏ß‡∏ô‡∏≠‡∏ô 2) ‡πÉ‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÅ‡∏ñ‡∏ß‡∏ï‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà 7+1 = 8 ‡πÇ‡∏î‡∏¢‡∏ö‡∏ß‡∏Å‡πÑ‡∏õ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢‡πÜ‡∏ó‡∏µ‡∏•‡∏∞ 1 ‡πÉ‡∏ô‡πÅ‡∏ñ‡∏ß‡∏ô‡∏≠‡∏ô
      var mes1 = row[0];                            // ‡∏£‡∏≠‡∏ö‡∏ó‡∏µ‡πà 2 ‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô ‡πÅ‡∏ñ‡∏ß‡∏ô‡∏≠‡∏ô 3 ‡πÅ‡∏ñ‡∏ß‡∏ï‡∏±‡πâ‡∏á 8 ‡∏•‡∏á‡πÑ‡∏õ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢‡πÜ
      var mes2 = row[1];
      var mes3 = row[2];
      var mes4 = row[3];
      var mes5 = row[4];
      var mes6 = row[5];
      var mes7 = row[6];
 

      all = '      ' + ' üì£   ' + mes7 + '    üì£ ' + '\n' + '\n' + 'üìå ' + '‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á : ' + mes2 + '\n' + '\n' + 'üëâ ' + '‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î : ' + mes3 +  '\n' + '\n' + 'üìç ' + '‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° :  ' + mes6 + '\n' + '\n' + '‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ñ‡∏≤‡∏£‡∏û' +  '\n' + mes4  ; 

      if(Sent != SEND){                // ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ß‡πà‡∏≤‡∏ñ‡πâ‡∏≤‡πÅ‡∏ñ‡∏ß‡∏ï‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà 7+1 ‡πÑ‡∏°‡πà‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° SEND ‡πÉ‡∏´‡πâ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ ‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏≠‡∏≤ all ‡∏°‡∏≤‡∏ß‡∏ô‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏£‡∏≠‡∏ö ‡πÅ‡∏•‡∏∞‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏≠‡∏∞‡πÑ‡∏£‡∏°‡∏≤ ‡πÉ‡∏´‡πâ‡∏ö‡∏ß‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢‡πÜ ‡∏ï‡πà‡∏≠‡πÜ‡∏Å‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏î‡∏µ‡∏¢‡∏ß 

      sheet.getRange(i+1,11).setValue(SEND);     // ‡∏£‡∏≠‡∏ö‡πÅ‡∏£‡∏Å‡πÉ‡∏´‡πâ‡πÄ‡∏ï‡∏¥‡∏°‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ SEND ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô ‡πÅ‡∏ñ‡∏ß‡∏ô‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1+1 ‡πÅ‡∏ñ‡∏ß‡∏ï‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà 8 ‡πÄ‡∏û‡∏£‡∏≤‡∏∞ () ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà []  
 
                                               // ‡∏à‡∏ö‡∏£‡∏≠‡∏ö ‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏õ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà‡∏à‡∏ô‡∏ñ‡∏∂‡∏á‡∏ä‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢


      var token = ["9T5MHxkdbz7hx92xpuIeTFEghWIKIXZQ40AVpKbGZBG"]; // ***‡πÉ‡∏™‡πà token ‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏° Line ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô***
      var options = {
            "method": "post",
            "payload": "message=" + all,        // ‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏™‡πà‡∏á‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ 
            "headers": {
            "Authorization": "Bearer " + token
            }
            };
      
          UrlFetchApp.fetch("https://notify-api.line.me/api/notify", options);
          

          Utilities.sleep(2000);    
          Logger.log(all);      // ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ all ‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á
    }  

    SpreadsheetApp.flush();     // ‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
 
  }
}


